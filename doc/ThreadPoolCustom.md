## 自定义线程池
> 生产环境不要使用线程池的工具类Executors，线程数量为Integer.MAX_VALUE 容易OOM
所以使用线程池时应自定义线程池，通过 new ThredPoolExecutor()构造方法创建。

***
## 线程池最大线程数（maximumPoolSize）如何选择？
* CPU密集型 :任务需要大量的运算，而没有阻塞，CPU一直全速运行
    * 多核CPU才有意义
    * 获取cup数量：Runtime.getRuntime().availableProcessors();
    * 尽可能少的线程数量：公式：CPU核数+1个线程的线程池
* IO密集型：任务需要大量的IO，即大量的阻塞
    1. 由于IO密集型任务并不是一直在执行任务，则应配置尽可能多的线程，如CPU核数*2
    2. 在单线程上运行IO密集型任务会导致大量的CPU运算能力浪费在等待。  
    所以在IO密集型任务中使用多线程可以大大的加速程序的运行，即使在单核CPU上，这种加速主要就是利用了被浪费掉的阻塞时间。  
    IO密集型时，大部分线程都阻塞，故需要多配置线程数量：  
    参考公式：**CPU核数/1-阻塞系数** ，阻塞系数0.8-0.9之间  
    比如8核CPU：8/1-0.9= 80个线程数